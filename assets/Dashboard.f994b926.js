var ve=Object.defineProperty;var he=(e,t,n)=>t in e?ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var K=(e,t,n)=>(he(e,typeof t!="symbol"?t+"":t,n),n);import{r as x,b as L,c as be,R as N,j as R,d as te,F as me}from"./vendor.da540a26.js";import{K as Q}from"./konva.1335705c.js";import{u as xe}from"./ahooks.3aed1a73.js";import{_ as we,i as _e,a as Ce}from"./common.a115089c.js";import{s as E,B as ie,r as Re,c as b,_ as g,a as B,b as U,d as ke,u as j,e as M,f as W,g as q,h as $e,i as se,j as ne,k as J,l as Te,m as Be,n as Ie,o as ze,t as oe,p as Ee,q as C,v as Ae,w as Pe}from"./@mui/material.4782ca5a.js";const X=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})(),Le=X?Promise.resolve().then(function(){return je}):Promise.resolve().then(function(){return De});async function We(...e){return(await Le).default(...e)}X?Promise.resolve().then(function(){return Ue}):Promise.resolve().then(function(){return He});X?Promise.resolve().then(function(){return Se}):Promise.resolve().then(function(){return Ke});const Oe=async e=>{const t=await e.getFile();return t.handle=e,t};var Fe=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const t=[];e.forEach((r,a)=>{t[a]={description:r.description||"Files",accept:{}},r.mimeTypes?r.mimeTypes.map(s=>{t[a].accept[s]=r.extensions||[]}):t[a].accept["*/*"]=r.extensions||[]});const n=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),o=await Promise.all(n.map(Oe));return e[0].multiple?o:o[0]},je={__proto__:null,default:Fe};function S(e){function t(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var o=n.done;return Promise.resolve(n.value).then(function(r){return{value:r,done:o}})}return S=function(n){this.s=n,this.n=n.next},S.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(n){var o=this.s.return;return o===void 0?Promise.resolve({value:n,done:!0}):t(o.apply(this.s,arguments))},throw:function(n){var o=this.s.return;return o===void 0?Promise.reject(n):t(o.apply(this.s,arguments))}},new S(e)}const le=async(e,t,n=e.name,o)=>{const r=[],a=[];var s,c=!1,i=!1;try{for(var l,d=function(p){var f,u,h,m=2;for(typeof Symbol<"u"&&(u=Symbol.asyncIterator,h=Symbol.iterator);m--;){if(u&&(f=p[u])!=null)return f.call(p);if(h&&(f=p[h])!=null)return new S(f.call(p));u="@@asyncIterator",h="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());c=!(l=await d.next()).done;c=!1){const p=l.value,f=`${n}/${p.name}`;p.kind==="file"?a.push(p.getFile().then(u=>(u.directoryHandle=e,u.handle=p,Object.defineProperty(u,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>f})))):p.kind!=="directory"||!t||o&&o(p)||r.push(le(p,t,f,o))}}catch(p){i=!0,s=p}finally{try{c&&d.return!=null&&await d.return()}finally{if(i)throw s}}return[...(await Promise.all(r)).flat(),...await Promise.all(a)]};var Me=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return le(t,e.recursive,void 0,e.skipDirectory)},Ue={__proto__:null,default:Me},Ne=async(e,t=[{}],n=null,o=!1,r=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const a=[];let s=null;if(e instanceof Blob&&e.type?s=e.type:e.headers&&e.headers.get("content-type")&&(s=e.headers.get("content-type")),t.forEach((l,d)=>{a[d]={description:l.description||"Files",accept:{}},l.mimeTypes?(d===0&&s&&l.mimeTypes.push(s),l.mimeTypes.map(p=>{a[d].accept[p]=l.extensions||[]})):s?a[d].accept[s]=l.extensions||[]:a[d].accept["*/*"]=l.extensions||[]}),n)try{await n.getFile()}catch(l){if(n=null,o)throw l}const c=n||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:a,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!n&&r&&r(c);const i=await c.createWritable();return"stream"in e?(await e.stream().pipeTo(i),c):"body"in e?(await e.body.pipeTo(i),c):(await i.write(await e),await i.close(),c)},Se={__proto__:null,default:Ne},Ve=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((t,n)=>{const o=document.createElement("input");o.type="file";const r=[...e.map(i=>i.mimeTypes||[]),...e.map(i=>i.extensions||[])].join();o.multiple=e[0].multiple||!1,o.accept=r||"",o.style.display="none",document.body.append(o);const a=i=>{typeof s=="function"&&s(),t(i)},s=e[0].legacySetup&&e[0].legacySetup(a,()=>s(n),o),c=()=>{window.removeEventListener("focus",c),o.remove()};o.addEventListener("click",()=>{window.addEventListener("focus",c)}),o.addEventListener("change",()=>{window.removeEventListener("focus",c),o.remove(),a(o.multiple?Array.from(o.files):o.files[0])}),"showPicker"in HTMLInputElement.prototype?o.showPicker():o.click()})),De={__proto__:null,default:Ve},Ge=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((t,n)=>{const o=document.createElement("input");o.type="file",o.webkitdirectory=!0;const r=s=>{typeof a=="function"&&a(),t(s)},a=e[0].legacySetup&&e[0].legacySetup(r,()=>a(n),o);o.addEventListener("change",()=>{let s=Array.from(o.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(s=s.filter(c=>c.webkitRelativePath.split("/").every(i=>!e[0].skipDirectory({name:i,kind:"directory"})))):s=s.filter(c=>c.webkitRelativePath.split("/").length===2),r(s)}),"showPicker"in HTMLInputElement.prototype?o.showPicker():o.click()})),He={__proto__:null,default:Ge},qe=async(e,t={})=>{Array.isArray(t)&&(t=t[0]);const n=document.createElement("a");let o=e;"body"in e&&(o=await async function(s,c){const i=s.getReader(),l=new ReadableStream({start:f=>async function u(){return i.read().then(({done:h,value:m})=>{if(!h)return f.enqueue(m),u();f.close()})}()}),d=new Response(l),p=await d.blob();return i.releaseLock(),new Blob([p],{type:c})}(e.body,e.headers.get("content-type"))),n.download=t.fileName||"Untitled",n.href=URL.createObjectURL(await o);const r=()=>{typeof a=="function"&&a()},a=t.legacySetup&&t.legacySetup(r,()=>a(),n);return n.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(n.href),3e4),r()}),n.click(),null},Ke={__proto__:null,default:qe};const Je={name:"1qk07wn",styles:"text-align:center;margin:0;padding:0.5em"},Qe={name:"zl1inp",styles:"display:flex;justify-content:center"},Xe={name:"1mjnbiv",styles:"width:70vmin;height:70vmin;display:block;flex:none;overflow:auto"},Ye={name:"15l7spb",styles:"width:100%;height:100%;display:block;background-color:#f2f2f2;flex:none"};var Ze=we,et=_e,tt=Ce,nt="[object String]";function ot(e){return typeof e=="string"||!et(e)&&tt(e)&&Ze(e)==nt}var rt=ot;const ce={async file2image(e){const t=await this.readyFileToDataURL(e);return await this.createImage(t)},readyFileToDataURL(e){return new Promise((t,n)=>{const o=new FileReader;o.onloadend=()=>{t(o.result),o.onloadend=null,o.onerror=null},o.onerror=r=>{n(r),o.onloadend=null,o.onerror=null},o.readAsDataURL(e)})},createImage(e){return new Promise((t,n)=>{const o=new Image;o.onload=()=>{t(o),o.onload=null,o.onerror=null},o.onerror=r=>{n(r),o.onload=null,o.onerror=null},o.src=e})},async scaleImage2Rect(e,t,n){rt(e)&&(e=await this.createImage(e));const{width:o,height:r}=e,a=Math.min(t/o,n/r);return t=o*a,n=r*a,{width:t,height:n}}},P=class{constructor(){K(this,"Stage",null)}static getInstance(){return P.instance||(P.instance=new P),P.instance}setStage(t){return this.Stage=t,this}setLayer(){const{Stage:t}=this;if(!t)throw new Error("Stage is null.your should setStage first");t.getLayers().find(o=>o.name()==="image")?console.warn("layer is exist.No need to set again"):t.add(new Q.Layer({name:"image"}))}async drawImage(t){const{Stage:n}=this;if(!n)throw new Error("Stage is null.your should setStage first");const o=n.getLayers().find(p=>p.name()==="image");if(!o)throw new Error("layer is null.your should setLayer first");o.removeChildren();const r=n.width(),a=n.height(),{width:s,height:c}=await ce.scaleImage2Rect(t,r,a),i=Math.floor((a-c)/2),l=Math.floor((r-s)/2),d=new Q.Image({image:t,width:s,height:c,y:i,x:l});return o.add(d),d}};let O=P;K(O,"instance");const at=x.exports.createContext({}),it=at,st=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],lt=e=>{const{color:t,disableElevation:n,fullWidth:o,size:r,variant:a,classes:s}=e,c={root:["root",a,`${a}${b(t)}`,`size${b(r)}`,`${a}Size${b(r)}`,t==="inherit"&&"colorInherit",n&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${b(r)}`],endIcon:["endIcon",`iconSize${b(r)}`]},i=q(c,$e,s);return g({},s,i)},de=e=>g({},e.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},e.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},e.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),ct=E(ie,{shouldForwardProp:e=>Re(e)||e==="classes",name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${b(n.color)}`],t[`size${b(n.size)}`],t[`${n.variant}Size${b(n.size)}`],n.color==="inherit"&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})(({theme:e,ownerState:t})=>{var n,o;return g({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(e.vars||e).shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":g({textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:B(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="text"&&t.color!=="inherit"&&{backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:B(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="outlined"&&t.color!=="inherit"&&{border:`1px solid ${(e.vars||e).palette[t.color].main}`,backgroundColor:e.vars?`rgba(${e.vars.palette[t.color].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:B(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},t.variant==="contained"&&{backgroundColor:(e.vars||e).palette.grey.A100,boxShadow:(e.vars||e).shadows[4],"@media (hover: none)":{boxShadow:(e.vars||e).shadows[2],backgroundColor:(e.vars||e).palette.grey[300]}},t.variant==="contained"&&t.color!=="inherit"&&{backgroundColor:(e.vars||e).palette[t.color].dark,"@media (hover: none)":{backgroundColor:(e.vars||e).palette[t.color].main}}),"&:active":g({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[8]}),[`&.${U.focusVisible}`]:g({},t.variant==="contained"&&{boxShadow:(e.vars||e).shadows[6]}),[`&.${U.disabled}`]:g({color:(e.vars||e).palette.action.disabled},t.variant==="outlined"&&{border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},t.variant==="outlined"&&t.color==="secondary"&&{border:`1px solid ${(e.vars||e).palette.action.disabled}`},t.variant==="contained"&&{color:(e.vars||e).palette.action.disabled,boxShadow:(e.vars||e).shadows[0],backgroundColor:(e.vars||e).palette.action.disabledBackground})},t.variant==="text"&&{padding:"6px 8px"},t.variant==="text"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main},t.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},t.variant==="outlined"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].main,border:e.vars?`1px solid rgba(${e.vars.palette[t.color].mainChannel} / 0.5)`:`1px solid ${B(e.palette[t.color].main,.5)}`},t.variant==="contained"&&{color:e.vars?e.vars.palette.text.primary:(n=(o=e.palette).getContrastText)==null?void 0:n.call(o,e.palette.grey[300]),backgroundColor:(e.vars||e).palette.grey[300],boxShadow:(e.vars||e).shadows[2]},t.variant==="contained"&&t.color!=="inherit"&&{color:(e.vars||e).palette[t.color].contrastText,backgroundColor:(e.vars||e).palette[t.color].main},t.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},t.size==="small"&&t.variant==="text"&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="text"&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="outlined"&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="outlined"&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},t.size==="small"&&t.variant==="contained"&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},t.size==="large"&&t.variant==="contained"&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})},({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${U.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${U.disabled}`]:{boxShadow:"none"}}),dt=E("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${b(n.size)}`]]}})(({ownerState:e})=>g({display:"inherit",marginRight:8,marginLeft:-4},e.size==="small"&&{marginLeft:-2},de(e))),pt=E("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${b(n.size)}`]]}})(({ownerState:e})=>g({display:"inherit",marginRight:-4,marginLeft:8},e.size==="small"&&{marginRight:-2},de(e))),ut=x.exports.forwardRef(function(t,n){const o=x.exports.useContext(it),r=ke(o,t),a=j({props:r,name:"MuiButton"}),{children:s,color:c="primary",component:i="button",className:l,disabled:d=!1,disableElevation:p=!1,disableFocusRipple:f=!1,endIcon:u,focusVisibleClassName:h,fullWidth:m=!1,size:_="medium",startIcon:$,type:A,variant:y="text"}=a,T=M(a,st),z=g({},a,{color:c,component:i,disabled:d,disableElevation:p,disableFocusRipple:f,fullWidth:m,size:_,type:A,variant:y}),w=lt(z),ge=$&&L(dt,{className:w.startIcon,ownerState:z,children:$}),ye=u&&L(pt,{className:w.endIcon,ownerState:z,children:u});return be(ct,g({ownerState:z,className:W(o.className,w.root,l),component:i,disabled:d,focusRipple:!f,focusVisibleClassName:W(w.focusVisible,h),ref:n,type:A},T,{classes:w,children:[ge,s,ye]}))}),ft=ut,gt=["component","direction","spacing","divider","children"];function yt(e,t){const n=x.exports.Children.toArray(e).filter(Boolean);return n.reduce((o,r,a)=>(o.push(r),a<n.length-1&&o.push(x.exports.cloneElement(t,{key:`separator-${a}`})),o),[])}const vt=e=>({row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"})[e],ht=({ownerState:e,theme:t})=>{let n=g({display:"flex",flexDirection:"column"},ne({theme:t},J({values:e.direction,breakpoints:t.breakpoints.values}),o=>({flexDirection:o})));if(e.spacing){const o=Te(t),r=Object.keys(t.breakpoints.values).reduce((i,l)=>((typeof e.spacing=="object"&&e.spacing[l]!=null||typeof e.direction=="object"&&e.direction[l]!=null)&&(i[l]=!0),i),{}),a=J({values:e.direction,base:r}),s=J({values:e.spacing,base:r});typeof a=="object"&&Object.keys(a).forEach((i,l,d)=>{if(!a[i]){const f=l>0?a[d[l-1]]:"column";a[i]=f}}),n=Be(n,ne({theme:t},s,(i,l)=>({"& > :not(style) + :not(style)":{margin:0,[`margin${vt(l?a[l]:e.direction)}`]:ze(o,i)}})))}return n=Ie(t.breakpoints,n),n},bt=E("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>[t.root]})(ht),mt=x.exports.forwardRef(function(t,n){const o=j({props:t,name:"MuiStack"}),r=se(o),{component:a="div",direction:s="column",spacing:c=0,divider:i,children:l}=r,d=M(r,gt);return L(bt,g({as:a,ownerState:{direction:s,spacing:c},ref:n},d,{children:i?yt(l,i):l}))}),xt=mt,wt=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],_t=e=>{const{classes:t,fullWidth:n,selected:o,disabled:r,size:a,color:s}=e,c={root:["root",o&&"selected",r&&"disabled",n&&"fullWidth",`size${b(a)}`,s]};return q(c,Ee,t)},Ct=E(ie,{name:"MuiToggleButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[`size${b(n.size)}`]]}})(({theme:e,ownerState:t})=>{let n=t.color==="standard"?e.palette.text.primary:e.palette[t.color].main,o;return e.vars&&(n=t.color==="standard"?e.vars.palette.text.primary:e.vars.palette[t.color].main,o=t.color==="standard"?e.vars.palette.text.primaryChannel:e.vars.palette[t.color].mainChannel),g({},e.typography.button,{borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active},t.fullWidth&&{width:"100%"},{[`&.${oe.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:e.vars?`rgba(${e.vars.palette.text.primaryChannel} / ${e.vars.palette.action.hoverOpacity})`:B(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${oe.selected}`]:{color:n,backgroundColor:e.vars?`rgba(${o} / ${e.vars.palette.action.selectedOpacity})`:B(n,e.palette.action.selectedOpacity),"&:hover":{backgroundColor:e.vars?`rgba(${o} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:B(n,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${o} / ${e.vars.palette.action.selectedOpacity})`:B(n,e.palette.action.selectedOpacity)}}}},t.size==="small"&&{padding:7,fontSize:e.typography.pxToRem(13)},t.size==="large"&&{padding:15,fontSize:e.typography.pxToRem(15)})}),Rt=x.exports.forwardRef(function(t,n){const o=j({props:t,name:"MuiToggleButton"}),{children:r,className:a,color:s="standard",disabled:c=!1,disableFocusRipple:i=!1,fullWidth:l=!1,onChange:d,onClick:p,selected:f,size:u="medium",value:h}=o,m=M(o,wt),_=g({},o,{color:s,disabled:c,disableFocusRipple:i,fullWidth:l,size:u}),$=_t(_),A=y=>{p&&(p(y,h),y.defaultPrevented)||d&&d(y,h)};return L(Ct,g({className:W($.root,a),disabled:c,focusRipple:!i,ref:n,onClick:A,onChange:d,value:h,ownerState:_,"aria-pressed":f},m,{children:r}))}),kt=Rt;function $t(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.indexOf(e)>=0:e===t}const Tt=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],Bt=e=>{const{classes:t,orientation:n,fullWidth:o,disabled:r}=e,a={root:["root",n==="vertical"&&"vertical",o&&"fullWidth"],grouped:["grouped",`grouped${b(n)}`,r&&"disabled"]};return q(a,Ae,t)},It=E("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[{[`& .${C.grouped}`]:t.grouped},{[`& .${C.grouped}`]:t[`grouped${b(n.orientation)}`]},t.root,n.orientation==="vertical"&&t.vertical,n.fullWidth&&t.fullWidth]}})(({ownerState:e,theme:t})=>g({display:"inline-flex",borderRadius:(t.vars||t).shape.borderRadius},e.orientation==="vertical"&&{flexDirection:"column"},e.fullWidth&&{width:"100%"},{[`& .${C.grouped}`]:g({},e.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${C.selected} + .${C.grouped}.${C.selected}`]:{borderTop:0,marginTop:0}})})),zt=x.exports.forwardRef(function(t,n){const o=j({props:t,name:"MuiToggleButtonGroup"}),{children:r,className:a,color:s="standard",disabled:c=!1,exclusive:i=!1,fullWidth:l=!1,onChange:d,orientation:p="horizontal",size:f="medium",value:u}=o,h=M(o,Tt),m=g({},o,{disabled:c,fullWidth:l,orientation:p,size:f}),_=Bt(m),$=(y,T)=>{if(!d)return;const z=u&&u.indexOf(T);let w;u&&z>=0?(w=u.slice(),w.splice(z,1)):w=u?u.concat(T):[T],d(y,w)},A=(y,T)=>{!d||d(y,u===T?null:T)};return L(It,g({role:"group",className:W(_.root,a),ref:n,ownerState:m},h,{children:x.exports.Children.map(r,y=>x.exports.isValidElement(y)?x.exports.cloneElement(y,{className:W(_.grouped,y.props.className),onChange:i?A:$,selected:y.props.selected===void 0?$t(y.props.value,u):y.props.selected,size:y.props.size||f,fullWidth:l,color:y.props.color||s,disabled:y.props.disabled||c}):null)}))}),Et=zt,At=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Pt=e=>{const{align:t,gutterBottom:n,noWrap:o,paragraph:r,variant:a,classes:s}=e,c={root:["root",a,e.align!=="inherit"&&`align${b(t)}`,n&&"gutterBottom",o&&"noWrap",r&&"paragraph"]};return q(c,Pe,s)},Lt=E("span",{name:"MuiTypography",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,n.variant&&t[n.variant],n.align!=="inherit"&&t[`align${b(n.align)}`],n.noWrap&&t.noWrap,n.gutterBottom&&t.gutterBottom,n.paragraph&&t.paragraph]}})(({theme:e,ownerState:t})=>g({margin:0},t.variant&&e.typography[t.variant],t.align!=="inherit"&&{textAlign:t.align},t.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},t.gutterBottom&&{marginBottom:"0.35em"},t.paragraph&&{marginBottom:16})),re={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},Wt={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ot=e=>Wt[e]||e,Ft=x.exports.forwardRef(function(t,n){const o=j({props:t,name:"MuiTypography"}),r=Ot(o.color),a=se(g({},o,{color:r})),{align:s="inherit",className:c,component:i,gutterBottom:l=!1,noWrap:d=!1,paragraph:p=!1,variant:f="body1",variantMapping:u=re}=a,h=M(a,At),m=g({},a,{align:s,color:r,className:c,component:i,gutterBottom:l,noWrap:d,paragraph:p,variant:f,variantMapping:u}),_=i||(p?"p":u[f]||re[f])||"span",$=Pt(m);return L(Lt,g({as:_,ref:n,ownerState:m,className:W($.root,c)},h))}),jt=Ft,Mt=e=>{const{data:t,value:n,disabled:o,onChange:r}=e,a=s=>r&&r(s);return R(Et,{disabled:o,value:n,orientation:"vertical",color:"primary",exclusive:!0,sx:{marginRight:1,flex:"none"},children:t.map((s,c)=>{const{value:i,title:l}=s;return R(kt,{value:i,onClick:()=>a(i),children:R(jt,{children:l})},c)})})},Ut=N.memo(Mt);let v;const k=new Array(32).fill(void 0);k.push(void 0,null,!0,!1);function V(e){return k[e]}let F=k.length;function Nt(e){e<36||(k[e]=F,F=e)}function St(e){const t=V(e);return Nt(e),t}const pe=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});pe.decode();let D=new Uint8Array;function Y(){return D.byteLength===0&&(D=new Uint8Array(v.memory.buffer)),D}function Vt(e,t){return pe.decode(Y().subarray(e,e+t))}function Z(e){F===k.length&&k.push(k.length+1);const t=F;return F=k[t],k[t]=e,t}let G=new Int32Array;function I(){return G.byteLength===0&&(G=new Int32Array(v.memory.buffer)),G}function ee(e,t){return Y().subarray(e/1,e/1+t)}function Dt(e){try{const r=v.__wbindgen_add_to_stack_pointer(-16);v.grayscale(r,Z(e));var t=I()[r/4+0],n=I()[r/4+1],o=ee(t,n).slice();return v.__wbindgen_free(t,n*1),o}finally{v.__wbindgen_add_to_stack_pointer(16)}}function Gt(e,t){try{const a=v.__wbindgen_add_to_stack_pointer(-16);v.threshold(a,Z(e),t);var n=I()[a/4+0],o=I()[a/4+1],r=ee(n,o).slice();return v.__wbindgen_free(n,o*1),r}finally{v.__wbindgen_add_to_stack_pointer(16)}}function Ht(e,t,n){try{const s=v.__wbindgen_add_to_stack_pointer(-16);v.to_canny(s,Z(e),t,n);var o=I()[s/4+0],r=I()[s/4+1],a=ee(o,r).slice();return v.__wbindgen_free(o,r*1),a}finally{v.__wbindgen_add_to_stack_pointer(16)}}let ue=0;function qt(e,t){const n=t(e.length*1);return Y().set(e,n/1),ue=e.length,n}async function Kt(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(o){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",o);else throw o}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}else{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}function Jt(){const e={};return e.wbg={},e.wbg.__wbindgen_object_drop_ref=function(t){St(t)},e.wbg.__wbg_width_6e17ed358e109a2f=function(t){return V(t).width},e.wbg.__wbg_height_3948020edf838414=function(t){return V(t).height},e.wbg.__wbg_data_f13601b88960b7eb=function(t,n){const o=V(n).data,r=qt(o,v.__wbindgen_malloc),a=ue;I()[t/4+1]=a,I()[t/4+0]=r},e.wbg.__wbindgen_throw=function(t,n){throw new Error(Vt(t,n))},e}function Qt(e,t){return v=e.exports,fe.__wbindgen_wasm_module=t,G=new Int32Array,D=new Uint8Array,v}async function fe(e){typeof e>"u"&&(e=new URL(""+new URL("image_bg.70dfb719.wasm",import.meta.url).href,self.location));const t=Jt();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:o}=await Kt(await e,t);return Qt(n,o)}const H={is_init:!1,async init(){return this.is_init||(await fe(),this.is_init=!0),this},Grayscale:e=>e.data.set(Dt(e)),Threshold:e=>e.data.set(Gt(e,128)),Canny:e=>e.data.set(Ht(e,30,300))},ae=[{title:"\u7070\u5EA6",value:1,handle:H.Grayscale},{title:"\u9ED1\u767D",value:2,handle:H.Threshold},{title:"Canny",value:3,handle:H.Canny}];function on(){const e=N.createRef(),[t,n]=N.useState(),[o,r]=N.useState(-1);xe(()=>{const{current:i}=e;if(!i)throw new Error("Container.current is null");const l=new Q.Stage({container:i,width:i.scrollWidth,height:i.scrollHeight});O.getInstance().setStage(l).setLayer()});const a=async()=>{const i=await We({extensions:[".png",".jpg",".jpeg",".gif",".bmp"],description:"\u56FE\u7247\u6587\u4EF6"}),l=await ce.file2image(i),d=await O.getInstance().drawImage(l);n(d),c(o,d)},s=i=>{i!==o&&(r(i),t&&c(i,t))},c=async(i,l)=>{await H.init();const d=ae.find(p=>p.value===i);d&&(l==null||l.cache(),l==null||l.filters([d.handle]))};return te(me,{children:[R("h1",{css:Je,children:"Konva\u7ED3\u5408rust\u65B0\u589E\u56FE\u7247\u6EE4\u955C\u6548\u679C"}),R(xt,{sx:{justifyContent:"center",paddingBottom:2},direction:"row",spacing:2,children:R(ft,{variant:"contained",onClick:()=>a(),children:"\u9009\u62E9\u6587\u4EF6"})}),te("div",{css:Qe,children:[R(Ut,{value:o,data:ae,disabled:!t,onChange:s}),R("div",{css:Xe,children:R("div",{ref:e,css:Ye})})]})]})}export{on as default};
